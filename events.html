<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>MTK - Musical Theatre for Kids - Classes & Events</title>
    <meta name="author" content="MTK">
    <meta name="description" content="Register for Musical Theatre Classes - Singing, Dancing, Acting, Script Writing for Kids">
    <meta name="keywords" content="Musical Theatre, Classes, Dancing, Singing, Acting, Script Writing, Kids">
    <meta name="robots" content="INDEX,FOLLOW">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="57x57" href="assets/img/logo-mtk.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/logo-mtk.png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Manrope:wght@200..800&family=Montez&display=swap" rel="stylesheet">

    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/fontawesome.min.css">
    <link rel="stylesheet" href="assets/css/magnific-popup.min.css">
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/custom-fixes.css">
</head>

<body>
    <!--[if lte IE 9]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
    <![endif]-->

    <div class="magic-cursor relative z-10">
        <div class="cursor"></div>
        <div class="cursor-follower"></div>
    </div>

    <!--==============================
     Preloader
  ==============================-->
    <div id="preloader" class="preloader">
        <button class="th-btn preloaderCls">Cancel Preloader</button>
        <div class="preloader-inner">
            <img src="assets/img/logo-mtk.png" width="150" height="150" alt="MTK">
        </div>
        <div id="loader" class="th-preloader">
            <div class="animation-preloader">
                <div class="txt-loading">
                    <span preloader-text="M" class="characters">M</span>
                    <span preloader-text="T" class="characters">T</span>
                    <span preloader-text="K" class="characters">K</span>
                </div>
            </div>
        </div>
    </div>

    <!--==============================
    Sidemenu
============================== -->
    <div class="sidemenu-wrapper sidemenu-info ">
        <div class="sidemenu-content">
            <button class="closeButton sideMenuCls"><i class="far fa-times"></i></button>
            <div class="widget  ">
                <div class="th-widget-about">
                    <div class="about-logo">
                        <a href="index.html"><img src="assets/img/logo2.svg" alt="MTK"></a>
                    </div>
                    <p class="about-text">Musical Theatre for Kids - Inspiring creativity through singing, dancing, acting, and script writing. We provide a nurturing and fun learning environment for young artists.</p>
                    <div class="th-social">
                        <a href="https://www.facebook.com/"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.twitter.com/"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.linkedin.com/"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.whatsapp.com/"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
            </div>
            <div class="widget  ">
                <h3 class="widget_title">Recent Posts</h3>
                <div class="recent-post-wrap">
                    <div class="recent-post">
                        <div class="media-img">
                            <a href="blog-details.html"><img src="assets/img/blog/recent-post-1-1.jpg" alt="Blog Image"></a>
                        </div>
                        <div class="media-body">
                            <div class="recent-post-meta">
                                <a href="blog.html"><i class="far fa-calendar"></i>24 Jun , 2024</a>
                            </div>
                            <h4 class="post-title"><a class="text-inherit" href="blog-details.html">Unlocking Creativity: The Benefits of Arts Education</a></h4>
                        </div>
                    </div>
                    <div class="recent-post">
                        <div class="media-img">
                            <a href="blog-details.html"><img src="assets/img/blog/recent-post-1-2.jpg" alt="Blog Image"></a>
                        </div>
                        <div class="media-body">
                            <div class="recent-post-meta">
                                <a href="blog.html"><i class="far fa-calendar"></i>22 Jun , 2024</a>
                            </div>
                            <h4 class="post-title"><a class="text-inherit" href="blog-details.html">Building Confidence Through Performance Arts</a></h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="widget  ">
                <h3 class="widget_title">Get In Touch</h3>
                <div class="th-widget-contact">
                    <div class="info-box_text">
                        <div class="icon">
                            <img src="assets/img/icon/phone.svg" alt="img">
                        </div>
                        <div class="details">
                            <p><a href="tel:+01234567890" class="info-box_link">+01 234 567 890</a></p>
                            <p><a href="tel:+09876543210" class="info-box_link">+09 876 543 210</a></p>
                        </div>
                    </div>
                    <div class="info-box_text">
                        <div class="icon">
                            <img src="assets/img/icon/envelope.svg" alt="img">
                        </div>
                        <div class="details">
                            <p><a href="mailto:mailinfo00@mtk.com" class="info-box_link">mailinfo00@mtk.com</a></p>
                            <p><a href="mailto:support24@mtk.com" class="info-box_link">support24@mtk.com</a></p>
                        </div>
                    </div>
                    <div class="info-box_text">
                        <div class="icon"><img src="assets/img/icon/location-dot.svg" alt="img"></div>
                        <div class="details">
                            <p>123 Creative Lane, Artville, California, USA</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="popup-search-box">
        <button class="searchClose"><i class="fal fa-times"></i></button>
        <form action="#">
            <input type="text" placeholder="What are you looking for?">
            <button type="submit"><i class="fal fa-search"></i></button>
        </form>
    </div>

    <!--==============================
    Mobile Menu
  ============================== -->
    <div class="th-menu-wrapper onepage-nav">
        <div class="th-menu-area text-center">
            <button class="th-menu-toggle"><i class="fal fa-times"></i></button>
            <div class="mobile-logo">
                <a href="index.html"><img src="assets/img/logo.png" width="180" height="150" alt="MTK"></a>
            </div>
            <div class="th-mobile-menu">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a class="active" href="events.html">Classes & Events</a></li>
                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!--==============================
	Header Area
==============================-->
    <header class="th-header header-layout1">
        <div class="header-top">
            <div class="container th-container">
                <div class="row justify-content-center justify-content-xl-between align-items-center">
                    <div class="col-auto d-none d-md-block">
                        <div class="header-links">
                            <ul>
                                <li class="d-none d-xl-inline-block"><i class="fa-sharp fa-regular  fa-location-dot"></i>
                                    <span>123 Creative Lane, Artville, CA</span>
                                </li>
                                <li class="d-none d-xl-inline-block"><i class="fa-regular fa-clock"></i>
                                    <span>Mon to Sat: 9.00 am - 6.00 pm</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-auto">
                        <div class="header-right">
                            <div class="currency-menu">
                                <img src="assets/img/icon/dollar.svg" alt="">
                                <select class="form-select nice-select">
                                    <option selected="">USD</option>
                                    <option>CNY</option>
                                    <option>EUR</option>
                                    <option>AUD</option>
                                </select>
                            </div>
                            <div class="header-links">
                                <ul>
                                    <li class="d-none d-md-inline-block"><a href="contact.html">Support</a></li>
                                    <li id="authLink"><a href="#" onclick="showAuthModal()">Sign In / Register<i class="fa-regular fa-user"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sticky-wrapper">
            <!-- Main Menu Area -->
            <div class="menu-area">
                <div class="container th-container">
                    <div class="row align-items-center justify-content-between">
                        <!-- Logo -->
                        <div class="col-auto">
                            <div class="header-logo">
                                <a href="index.html">
                                    <img src="assets/img/logo.png" width="150" height="150" alt="MTK">
                                </a>
                            </div>
                        </div>

                        <!-- Centered Navbar -->
                        <div class="col text-center">
                            <nav class="main-menu d-none d-xl-inline-block">
                                <ul class="d-flex justify-content-center gap-4 m-0">
                                    <li><a href="index.html">Home</a></li>
                                    <li><a href="about.html">About Us</a></li>
                                    <li><a class="active" href="events.html">Classes & Events</a></li>
                                    <li><a href="contact.html">Contact Us</a></li>
                                </ul>
                            </nav>
                            <button type="button" class="th-menu-toggle d-block d-xl-none">
                                <i class="far fa-bars"></i>
                            </button>
                        </div>

                        <!-- Book Now Button -->
                        <div class="col-auto d-none d-xl-block">
                            <div class="header-button">
                                <a href="contact.html" class="th-btn style3 th-icon">Register Now</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="logo-bg" data-mask-src="assets/img/logo_bg_mask.png"></div>
            </div>
        </div>
    </header>

    <!--==============================
    Breadcumb
============================== -->
    <div class="breadcumb-wrapper " data-bg-src="assets/img/bg/breadcumb-bg.jpg">
        <div class="container">
            <div class="breadcumb-content">
                <h1 class="breadcumb-title">Classes & Events</h1>
                <ul class="breadcumb-menu">
                    <li><a href="index.html">Home</a></li>
                    <li>Classes & Events</li>
                </ul>
            </div>
        </div>
    </div>

    <!--==============================
Events Area  
==============================-->
    <section class="position-relative overflow-hidden space" id="events-sec">
        <div class="container">
            <div class="title-area text-center mb-50">
                <span class="sub-title">Join Our Classes</span>
                <h2 class="sec-title">Musical Theatre Classes & Events</h2>
                <p class="sec-text">Discover amazing opportunities for your child to learn singing, dancing, acting, and script writing from professional instructors in a fun and supportive environment.</p>
            </div>

            <!-- User Info -->
            <div id="userInfo" class="user-info" style="display: none;">
                <div class="alert alert-success d-flex align-items-center">
                    <i class="fa fa-user me-2"></i>
                    <span>Welcome back, <strong id="userName"></strong>!</span>
                </div>
            </div>

            <!-- Filter Tabs -->
            <div class="filter-tabs">
                <div class="filter-tab active" data-category="all">All Classes</div>
                <div class="filter-tab" data-category="dancing">Dancing</div>
                <div class="filter-tab" data-category="singing">Singing</div>
                <div class="filter-tab" data-category="acting">Acting</div>
                <div class="filter-tab" data-category="script_writing">Script Writing</div>
            </div>

            <!-- Events Grid -->
            <div class="row gy-30" id="eventsContainer">
                <!-- Events will be loaded here -->
            </div>

            <!-- No Events Message -->
            <div id="noEventsMessage" class="text-center" style="display: none; margin-bottom: 100px;">
                <h4>No events available</h4>
                <p>Please check back later for new classes and events!</p>
            </div>
        </div>
    </section>

    <!--==============================
	Footer Area
==============================-->
    <footer class="footer-wrapper footer-layout1">
        <div class="widget-area">
            <div class="container">
                <div class="row justify-content-between">
                    <div class="col-md-6 col-xl-3">
                        <div class="widget footer-widget">
                            <div class="th-widget-about">
                                <div class="about-logo">
                                    <a href="index.html"><img src="assets/img/logo-mtk.png" width="150" height="150" alt="MTK"></a>
                                </div>
                                <p class="about-text">Musical Theatre for Kids - Inspiring creativity through singing, dancing, acting, and script writing. We provide a nurturing and fun learning environment for young artists.</p>
                                <div class="th-social">
                                    <a href="https://www.facebook.com/"><i class="fab fa-facebook-f"></i></a>
                                    <a href="https://www.twitter.com/"><i class="fab fa-twitter"></i></a>
                                    <a href="https://www.linkedin.com/"><i class="fab fa-linkedin-in"></i></a>
                                    <a href="https://www.whatsapp.com/"><i class="fab fa-whatsapp"></i></a>
                                    <a href="https://instagram.com/"><i class="fab fa-instagram"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-xl-auto">
                        <div class="widget widget_nav_menu footer-widget">
                            <h3 class="widget_title">Quick Links</h3>
                            <div class="menu-all-pages-container">
                                <ul class="menu">
                                    <li><a href="index.html">Home</a></li>
                                    <li><a href="about.html">About us</a></li>
                                    <li><a href="events.html">Classes & Events</a></li>
                                    <li><a href="contact.html">Contact us</a></li>
                                    <li><a href="contact.html">Terms of Service</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-xl-auto">
                        <div class="widget footer-widget">
                            <h3 class="widget_title">Contact Us</h3>
                            <div class="th-widget-contact">
                                <div class="info-box_text">
                                    <div class="icon">
                                        <img src="assets/img/icon/phone.svg" alt="img">
                                    </div>
                                    <div class="details">
                                        <p><a href="tel:+01234567890" class="info-box_link">+01 234 567 890</a></p>
                                        <p><a href="tel:+09876543210" class="info-box_link">+09 876 543 210</a></p>
                                    </div>
                                </div>
                                <div class="info-box_text">
                                    <div class="icon">
                                        <img src="assets/img/icon/envelope.svg" alt="img">
                                    </div>
                                    <div class="details">
                                        <p><a href="mailto:mailinfo00@mtk.com" class="info-box_link">mailinfo00@mtk.com</a></p>
                                        <p><a href="mailto:support24@mtk.com" class="info-box_link">support24@mtk.com</a></p>
                                    </div>
                                </div>
                                <div class="info-box_text">
                                    <div class="icon"><img src="assets/img/icon/location-dot.svg" alt="img"></div>
                                    <div class="details">
                                        <p>123 Creative Lane, Artville, California, USA</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-xl-auto">
                        <div class="widget footer-widget">
                            <h3 class="widget_title">Instagram Post</h3>
                            <div class="sidebar-gallery">
                                <div class="gallery-thumb">
                                    <img src="assets/img/widget/gallery_1_1.jpg" alt="Gallery Image">
                                    <a target="_blank" href="https://www.instagram.com/" class="gallery-btn"><i class="fab fa-instagram"></i></a>
                                </div>
                                <div class="gallery-thumb">
                                    <img src="assets/img/widget/gallery_1_2.jpg" alt="Gallery Image">
                                    <a target="_blank" href="https://www.instagram.com/" class="gallery-btn"><i class="fab fa-instagram"></i></a>
                                </div>
                                <div class="gallery-thumb">
                                    <img src="assets/img/widget/gallery_1_3.jpg" alt="Gallery Image">
                                    <a target="_blank" href="https://www.instagram.com/" class="gallery-btn"><i class="fab fa-instagram"></i></a>
                                </div>
                                <div class="gallery-thumb">
                                    <img src="assets/img/widget/gallery_1_4.jpg" alt="Gallery Image">
                                    <a target="_blank" href="https://www.instagram.com/" class="gallery-btn"><i class="fab fa-instagram"></i></a>
                                </div>
                                <div class="gallery-thumb">
                                    <img src="assets/img/widget/gallery_1_5.jpg" alt="Gallery Image">
                                    <a target="_blank" href="https://www.instagram.com/" class="gallery-btn"><i class="fab fa-instagram"></i></a>
                                </div>
                                <div class="gallery-thumb">
                                    <img src="assets/img/widget/gallery_1_6.jpg" alt="Gallery Image">
                                    <a target="_blank" href="https://www.instagram.com/" class="gallery-btn"><i class="fab fa-instagram"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copyright-wrap" data-bg-src="assets/img/bg/copyright_bg_1.jpg">
            <div class="container">
                <div class="row justify-content-between align-items-center">
                    <div class="col-md-6">
                        <p class="copyright-text">Copyright 2024 <a href="index.html">MTK - Musical Theatre for Kids</a>. All Rights Reserved.</p>
                    </div>
                    <div class="col-md-6 text-end d-none d-md-block">
                        <div class="footer-card">
                            <span class="title">We Accept</span>
                            <img src="assets/img/shape/cards.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll To Top -->
    <div class="scroll-top">
        <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
            <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" style="transition: stroke-dashoffset 10ms linear 0s; stroke-dasharray: 307.919, 307.919; stroke-dashoffset: 307.919;"></path>
        </svg>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999;">
        <div class="auth-modal-content" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 40px; border-radius: 16px; width: 90%; max-width: 500px;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 id="authModalTitle">Sign In</h3>
                <button type="button" class="btn-close" onclick="closeAuthModal()" style="background: none; border: none; font-size: 24px; cursor: pointer;">×</button>
            </div>

            <!-- Login Form -->
            <form id="loginForm" style="display: block;">
                <div class="mb-3">
                    <label class="form-label">Username or Email</label>
                    <input type="text" class="form-control" id="loginUsername" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                </div>
                <button type="submit" class="th-btn w-100 mb-3">Sign In</button>
                <p class="text-center">Don't have an account? <a href="#" onclick="switchToRegister()">Register here</a></p>
            </form>

            <!-- Register Form -->
            <form id="registerForm" style="display: none;">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" id="regUsername" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="regFullName" required>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="regEmail" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-control" id="regPhone">
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="regPassword" required>
                </div>
                <button type="submit" class="th-btn w-100 mb-3">Register</button>
                <p class="text-center">Already have an account? <a href="#" onclick="switchToLogin()">Sign in here</a></p>
            </form>
        </div>
    </div>

    <!-- Registration Modal -->
    <div class="registration-modal" id="registrationModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999;">
        <div class="registration-modal-content" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 40px; border-radius: 16px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 id="registrationModalTitle">Register for Event</h3>
                <button type="button" class="btn-close" onclick="closeRegistrationModal()" style="background: none; border: none; font-size: 24px; cursor: pointer;">×</button>
            </div>

            <form id="eventRegistrationForm">
                <input type="hidden" id="selectedEventId">
                <div class="event-details mb-4" id="eventDetails">
                    <!-- Event details will be populated here -->
                </div>

                <div class="mb-3">
                    <label class="form-label">Special Notes (Optional)</label>
                    <textarea class="form-control" id="registrationNotes" rows="3" placeholder="Any special requirements or notes..."></textarea>
                </div>

                <div class="d-flex gap-3">
                    <button type="button" class="th-btn style2" onclick="closeRegistrationModal()">Cancel</button>
                    <button type="submit" class="th-btn">Register Now</button>
                </div>
            </form>
        </div>
    </div>

    <!--==============================
    All Js File
============================== -->
    <script src="assets/js/vendor/jquery-3.6.0.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <script src="assets/js/imagesloaded.pkgd.min.js"></script>
    <script src="assets/js/isotope.pkgd.min.js"></script>
    <script src="assets/js/nice-select.min.js"></script>
    <script src="assets/js/circle-progress.js"></script>
    <script src="assets/js/jquery.counterup.min.js"></script>
    <script src="assets/js/swiper-bundle.min.js"></script>
    <!-- Animation Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script>
        // Initialize nice-select only if elements exist
        $(document).ready(function() {
            if (typeof $.fn.niceSelect !== 'undefined' && $('.nice-select-enabled').length > 0) {
                $('.nice-select-enabled').niceSelect();
            }
        });
    </script>
    <script src="assets/js/main.js"></script>

    <script>
        let eventsCurrentUser = null;
        let allEvents = [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            loadEvents();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Auth forms
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('eventRegistrationForm').addEventListener('submit', handleEventRegistration);

            // Filter buttons
            document.querySelectorAll('.filter-tab').forEach(button => {
                button.addEventListener('click', function() {
                    const filter = this.getAttribute('data-category');
                    filterEvents(filter);

                    // Update active button
                    document.querySelectorAll('.filter-tab').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        async function checkAuthStatus() {
            try {
                const response = await fetch('/api/user');
                const data = await response.json();

                if (data.success) {
                    eventsCurrentUser = data.user;
                    updateAuthUI();
                }
            } catch (error) {
                console.error('Auth check failed:', error);
            }
        }

        function updateAuthUI() {
            if (eventsCurrentUser) {
                document.getElementById('authLink').innerHTML = `<a href="#" onclick="logout()">${eventsCurrentUser.full_name} - Logout</a>`;
                document.getElementById('userInfo').style.display = 'block';
                document.getElementById('userName').textContent = eventsCurrentUser.full_name;
            } else {
                document.getElementById('authLink').innerHTML = '<a href="#" onclick="showAuthModal()">Sign In / Register<i class="fa-regular fa-user"></i></a>';
                document.getElementById('userInfo').style.display = 'none';
            }
        }

        async function loadEvents() {
            try {
                const response = await fetch('/api/events');
                const data = await response.json();

                if (data.success) {
                    allEvents = data.events;
                    displayEvents(allEvents);
                } else {
                    document.getElementById('noEventsMessage').style.display = 'block';
                }
            } catch (error) {
                console.error('Failed to load events:', error);
                document.getElementById('noEventsMessage').style.display = 'block';
            }
        }

        function displayEvents(events) {
            const container = document.getElementById('eventsContainer');
            const noEventsMsg = document.getElementById('noEventsMessage');

            if (events.length === 0) {
                container.innerHTML = '';
                noEventsMsg.style.display = 'block';
                return;
            }

            noEventsMsg.style.display = 'none';

            container.innerHTML = events.map(event => {
                const eventDate = new Date(event.date).toLocaleDateString();
                const eventTime = event.time.substring(0, 5);
                const isFullyBooked = event.available_slots <= 0;

                // Category-based images
                const categoryImages = {
                    dancing: 'assets/img/tour/tour_box_1.jpg',
                    singing: 'assets/img/tour/tour_box_2.jpg',
                    acting: 'assets/img/tour/tour_box_3.jpg',
                    script_writing: 'assets/img/tour/tour_box_4.jpg'
                };

                const imageUrl = event.image_url || categoryImages[event.category] || 'assets/img/tour/tour_box_1.jpg';

                return `
                    <div class="col-xl-4 col-lg-6 col-md-6 filter-item ${event.category}">
                        <div class="tour-box th-ani gsap-cursor">
                            <div class="tour-box_img global-img">
                                <img src="${imageUrl}" alt="${event.title}">
                                ${isFullyBooked ? '<div class="sold-out-badge" style="position: absolute; top: 10px; right: 10px; background: red; color: white; padding: 5px 10px; border-radius: 5px; font-size: 12px;">Sold Out</div>' : ''}
                            </div>
                            <div class="tour-content">
                                <h3 class="box-title"><a href="#">${event.title}</a></h3>
                                <div class="tour-rating">
                                    <div class="star-rating" role="img" aria-label="Rated 5.00 out of 5">
                                        <span style="width:100%">★★★★★</span>
                                    </div>
                                    <span class="category-badge" style="background: #667eea; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: 10px;">
                                        ${event.category.replace('_', ' ').toUpperCase()}
                                    </span>
                                </div>
                                <div class="event-meta" style="font-size: 13px; color: #666; margin: 10px 0;">
                                    <span><i class="fa fa-calendar"></i> ${eventDate}</span> | 
                                    <span><i class="fa fa-clock"></i> ${eventTime}</span>
                                    <br>
                                    <span><i class="fa fa-map-marker-alt"></i> ${event.location || 'Main Studio'}</span>
                                    <br>
                                    <span><i class="fa fa-users"></i> ${event.available_slots} slots left</span> | 
                                    <span><i class="fa fa-user-graduate"></i> ${event.age_group || 'All Ages'}</span>
                                </div>
                                <p class="event-description" style="font-size: 14px; color: #777; margin: 10px 0;">${event.description.substring(0, 100)}...</p>
                                <h4 class="tour-box_price"><span class="currency">$${event.amount}</span>/Class</h4>
                                <div class="tour-action">
                                    <span><i class="fa-light fa-clock"></i>${event.duration || '1 Hour'}</span>
                                    ${isFullyBooked ? 
                                        '<button class="th-btn style4 th-icon" disabled>Sold Out</button>' :
                                        `<button class="th-btn style4 th-icon" onclick="showRegistrationModal(${event.id})">Register Now</button>`
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterEvents(filter) {
            if (filter === 'all') {
                displayEvents(allEvents);
            } else {
                const filtered = allEvents.filter(event => event.category === filter);
                displayEvents(filtered);
            }
        }

        function showAuthModal() {
            document.getElementById('authModal').style.display = 'block';
        }

        function closeAuthModal() {
            document.getElementById('authModal').style.display = 'none';
        }

        function switchToRegister() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = 'Register';
        }

        function switchToLogin() {
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = 'Sign In';
        }

        function showRegistrationModal(eventId) {
            if (!eventsCurrentUser) {
                showAuthModal();
                return;
            }

            const event = allEvents.find(e => e.id === eventId);
            if (!event) return;

            document.getElementById('selectedEventId').value = eventId;
            document.getElementById('registrationModalTitle').textContent = `Register for ${event.title}`;

            const eventDate = new Date(event.date).toLocaleDateString();
            const eventTime = event.time.substring(0, 5);

            document.getElementById('eventDetails').innerHTML = `
                <div class="event-summary p-3" style="background: #f8f9fa; border-radius: 8px;">
                    <h5>${event.title}</h5>
                    <p class="mb-2"><strong>Date:</strong> ${eventDate}</p>
                    <p class="mb-2"><strong>Time:</strong> ${eventTime}</p>
                    <p class="mb-2"><strong>Duration:</strong> ${event.duration || '1 Hour'}</p>
                    <p class="mb-2"><strong>Location:</strong> ${event.location || 'Main Studio'}</p>
                    <p class="mb-2"><strong>Age Group:</strong> ${event.age_group || 'All Ages'}</p>
                    <p class="mb-2"><strong>Price:</strong> $${event.amount}</p>
                    <p class="mb-0"><strong>Available Slots:</strong> ${event.available_slots}</p>
                </div>
            `;

            document.getElementById('registrationModal').style.display = 'block';
        }

        function closeRegistrationModal() {
            document.getElementById('registrationModal').style.display = 'none';
            document.getElementById('eventRegistrationForm').reset();
        }

        async function handleLogin(e) {
            e.preventDefault();

            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (data.success) {
                    eventsCurrentUser = data.user;
                    updateAuthUI();
                    closeAuthModal();

                    if (data.user.is_admin) {
                        window.location.href = 'admin.html';
                    } else {
                        alert('Login successful!');
                    }
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('Login failed. Please try again.');
            }
        }

        async function handleRegister(e) {
            e.preventDefault();

            const userData = {
                username: document.getElementById('regUsername').value,
                email: document.getElementById('regEmail').value,
                password: document.getElementById('regPassword').value,
                full_name: document.getElementById('regFullName').value,
                phone: document.getElementById('regPhone').value
            };

            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(userData)
                });

                const data = await response.json();

                if (data.success) {
                    alert('Registration successful! Please sign in.');
                    switchToLogin();
                    document.getElementById('registerForm').reset();
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('Registration failed. Please try again.');
            }
        }

        async function handleEventRegistration(e) {
            e.preventDefault();

            const eventId = document.getElementById('selectedEventId').value;
            const notes = document.getElementById('registrationNotes').value;

            try {
                const response = await fetch('/api/register-event', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ event_id: eventId, notes: notes })
                });

                const data = await response.json();

                if (data.success) {
                    alert('Successfully registered for the event!');
                    closeRegistrationModal();
                    loadEvents(); // Reload events to update available slots
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('Registration failed. Please try again.');
            }
        }

        async function logout() {
            try {
                await fetch('/api/logout', { method: 'POST' });
                eventsCurrentUser = null;
                updateAuthUI();
                alert('Logged out successfully!');
            } catch (error) {
                console.error('Logout failed:', error);
            }
        }
    </script>

</body>

</html>