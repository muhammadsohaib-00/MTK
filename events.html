
<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>M T K - Classes & Events</title>
    <meta name="author" content="M T K">
    <meta name="description" content="Register for Musical Theatre Classes">
    <meta name="keywords" content="Musical Theatre, Classes, Dancing, Singing, Acting">
    <meta name="robots" content="INDEX,FOLLOW">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="57x57" href="assets/img/logo-mtk.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/logo-mtk.png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Manrope:wght@200..800&family=Montez&display=swap" rel="stylesheet">

    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/fontawesome.min.css">
    <link rel="stylesheet" href="assets/css/magnific-popup.min.css">
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    
    <style>
        .event-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 30px;
            width: 100%;
        }
        
        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .event-image {
            height: 250px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }
        
        .event-category {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.9);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .event-category.dancing { background: rgba(255,107,107,0.9); color: white; }
        .event-category.singing { background: rgba(54,162,235,0.9); color: white; }
        .event-category.acting { background: rgba(255,206,84,0.9); color: white; }
        .event-category.script_writing { background: rgba(75,192,192,0.9); color: white; }
        
        .slots-available {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(34,197,94,0.9);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .slots-full {
            background: rgba(239,68,68,0.9) !important;
        }
        
        .event-content {
            padding: 25px;
        }
        
        .event-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1f2937;
        }
        
        .event-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #6b7280;
        }
        
        .event-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .event-description {
            color: #4b5563;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .event-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        
        .event-price {
            font-size: 28px;
            font-weight: 700;
            color: #10b981;
        }
        
        .register-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .register-btn:hover {
            transform: scale(1.05);
            color: white;
        }
        
        .register-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        
        .filter-tabs {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .filter-tab {
            padding: 10px 25px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .filter-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }
        
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
        }
        
        .auth-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
        }
        
        .user-info {
            background: rgba(16,185,129,0.1);
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }
        
        .registration-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
        }
        
        .registration-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        @media (max-width: 768px) {
            .filter-tabs {
                gap: 10px;
            }
            
            .filter-tab {
                padding: 8px 15px;
                font-size: 14px;
            }
            
            .event-meta {
                flex-direction: column;
                gap: 10px;
            }
            
            .event-details {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .registration-modal-content,
            .auth-modal-content {
                padding: 20px;
                width: 95%;
            }
            
            .event-image {
                height: 200px;
            }
            
            .event-title {
                font-size: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .filter-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .filter-tab {
                width: 100%;
                max-width: 250px;
                text-align: center;
            }
            
            .event-content {
                padding: 20px;
            }
            
            .event-price {
                font-size: 24px;
            }
        }
    </style>
</head>

<body>
    <!-- Preloader -->
    <div id="preloader" class="preloader">
        <button class="th-btn preloaderCls">Cancel Preloader</button>
        <div class="preloader-inner">
            <img src="assets/img/logo-mtk.png" width="150" height="150" alt="">
        </div>
        <div id="loader" class="th-preloader">
            <div class="animation-preloader">
                <div class="txt-loading">
                    <span preloader-text="M" class="characters">M</span>
                    <span preloader-text="T" class="characters">T</span>
                    <span preloader-text="K" class="characters">K</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div class="th-menu-wrapper onepage-nav">
        <div class="th-menu-area text-center">
            <button class="th-menu-toggle"><i class="fal fa-times"></i></button>
            <div class="mobile-logo">
                <a href="index.html"><img src="assets/img/logo.png" width="180" height="150" alt="M T K"></a>
            </div>
            <div class="th-mobile-menu">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a class="active" href="events.html">Classes & Events</a></li>
                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="th-header header-layout1">
        <div class="header-top">
            <div class="container th-container">
                <div class="row justify-content-center justify-content-xl-between align-items-center">
                    <div class="col-auto d-none d-md-block">
                        <div class="header-links">
                            <ul>
                                <li class="d-none d-xl-inline-block">
                                    <i class="fa-sharp fa-regular fa-location-dot"></i>
                                    <span>45 New Eskaton Road, Austria</span>
                                </li>
                                <li class="d-none d-xl-inline-block">
                                    <i class="fa-regular fa-clock"></i>
                                    <span>Sun to Friday: 8.00 am - 7.00 pm</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-auto">
                        <div class="header-right">
                            <div class="header-links">
                                <ul>
                                    <li class="d-none d-md-inline-block"><a href="contact.html">Support</a></li>
                                    <li id="authLink"><a href="#" onclick="showAuthModal()">Sign In / Register<i class="fa-regular fa-user"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="sticky-wrapper">
            <div class="menu-area">
                <div class="container th-container">
                    <div class="row align-items-center justify-content-between">
                        <div class="col-auto">
                            <div class="header-logo">
                                <a href="index.html">
                                    <img src="assets/img/logo.png" width="150" height="150" alt="M T K">
                                </a>
                            </div>
                        </div>
                        
                        <div class="col text-center">
                            <nav class="main-menu d-none d-xl-inline-block">
                                <ul class="d-flex justify-content-center gap-4 m-0">
                                    <li><a href="index.html">Home</a></li>
                                    <li><a href="about.html">About Us</a></li>
                                    <li><a class="active" href="events.html">Classes & Events</a></li>
                                    <li><a href="contact.html">Contact Us</a></li>
                                </ul>
                            </nav>
                            <button type="button" class="th-menu-toggle d-block d-xl-none">
                                <i class="far fa-bars"></i>
                            </button>
                        </div>
                        
                        <div class="col-auto d-none d-xl-block">
                            <div class="header-button">
                                <a href="events.html" class="th-btn style3 th-icon">Register Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="breadcumb-wrapper" data-bg-src="assets/img/bg/breadcumb-bg.jpg">
        <div class="container">
            <div class="breadcumb-content">
                <h1 class="breadcumb-title">Classes & Events</h1>
                <ul class="breadcumb-menu">
                    <li><a href="index.html">Home</a></li>
                    <li>Classes & Events</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- User Info Section -->
    <div class="container">
        <div class="user-info" id="userInfo">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="mb-1">Welcome back, <span id="userName"></span>!</h5>
                    <p class="mb-0">Browse and register for upcoming classes and events</p>
                </div>
                <button class="th-btn style3" onclick="logout()">Logout</button>
            </div>
        </div>
    </div>

    <!-- Events Section -->
    <div class="space">
        <div class="container">
            <div class="title-area text-center mb-5">
                <span class="sub-title">Join Our Classes</span>
                <h2 class="sec-title">Upcoming Classes & Events</h2>
                <p class="sec-text">Discover amazing opportunities to learn and grow in musical theatre</p>
            </div>

            <!-- Filter Tabs -->
            <div class="filter-tabs">
                <div class="filter-tab active" data-category="all">All Classes</div>
                <div class="filter-tab" data-category="dancing">Dancing</div>
                <div class="filter-tab" data-category="singing">Singing</div>
                <div class="filter-tab" data-category="acting">Acting</div>
                <div class="filter-tab" data-category="script_writing">Script Writing</div>
            </div>

            <!-- Events Grid -->
            <div class="row" id="eventsContainer">
                <!-- Events will be loaded here -->
            </div>

            <!-- No Events Message -->
            <div id="noEventsMessage" class="text-center" style="display: none;">
                <h4>No events found</h4>
                <p>Check back later for new classes and events!</p>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-modal-content">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 id="authModalTitle">Sign In</h3>
                <button type="button" class="btn-close" onclick="closeAuthModal()">×</button>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm" style="display: block;">
                <div class="mb-3">
                    <label class="form-label">Username or Email</label>
                    <input type="text" class="form-control" id="loginUsername" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                </div>
                <button type="submit" class="th-btn w-100 mb-3">Sign In</button>
                <p class="text-center">Don't have an account? <a href="#" onclick="switchToRegister()">Register here</a></p>
            </form>
            
            <!-- Register Form -->
            <form id="registerForm" style="display: none;">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" id="regUsername" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="regFullName" required>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="regEmail" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-control" id="regPhone">
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="regPassword" required>
                </div>
                <button type="submit" class="th-btn w-100 mb-3">Register</button>
                <p class="text-center">Already have an account? <a href="#" onclick="switchToLogin()">Sign in here</a></p>
            </form>
        </div>
    </div>

    <!-- Registration Modal -->
    <div class="registration-modal" id="registrationModal">
        <div class="registration-modal-content">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3>Register for Class</h3>
                <button type="button" class="btn-close" onclick="closeRegistrationModal()">×</button>
            </div>
            
            <div id="eventDetails"></div>
            
            <form id="eventRegistrationForm">
                <input type="hidden" id="selectedEventId">
                <div class="mb-3">
                    <label class="form-label">Additional Notes (Optional)</label>
                    <textarea class="form-control" id="registrationNotes" rows="3" placeholder="Any special requirements or questions..."></textarea>
                </div>
                <div class="d-flex gap-3">
                    <button type="button" class="btn btn-secondary" onclick="closeRegistrationModal()">Cancel</button>
                    <button type="submit" class="th-btn">Confirm Registration</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-wrapper footer-layout1">
        <div class="widget-area">
            <div class="container">
                <div class="row justify-content-between">
                    <div class="col-md-6 col-xl-3">
                        <div class="widget footer-widget">
                            <div class="th-widget-about">
                                <div class="about-logo">
                                    <a href="index.html"><img src="assets/img/logo-mtk.png" width="150" height="150" alt="M T K"></a>
                                </div>
                                <p class="about-text">Nurturing young talent in musical theatre through professional classes and workshops.</p>
                                <div class="th-social">
                                    <a href="https://www.facebook.com/"><i class="fab fa-facebook-f"></i></a>
                                    <a href="https://www.twitter.com/"><i class="fab fa-twitter"></i></a>
                                    <a href="https://www.linkedin.com/"><i class="fab fa-linkedin-in"></i></a>
                                    <a href="https://www.whatsapp.com/"><i class="fab fa-whatsapp"></i></a>
                                    <a href="https://instagram.com/"><i class="fab fa-instagram"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copyright-wrap" data-bg-src="assets/img/bg/copyright_bg_1.jpg">
            <div class="container">
                <div class="row justify-content-between align-items-center">
                    <div class="col-md-6">
                        <p class="copyright-text">Copyright 2024 <a href="index.html">M T K</a>. All Rights Reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="assets/js/vendor/jquery-3.6.0.min.js"></script>
    <script src="assets/js/swiper-bundle.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/magnific-popup.min.js"></script>
    <script src="assets/js/main.js"></script>
    
    <script>
        let currentUser = null;
        let allEvents = [];
        let currentFilter = 'all';

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            loadEvents();
            setupEventListeners();
            
            // Check if redirected from home page
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('from') === 'home') {
                // Scroll to events section or highlight events
                setTimeout(() => {
                    document.querySelector('.title-area').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'center' 
                    });
                }, 500);
            }
        });

        function setupEventListeners() {
            // Filter tabs
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.category;
                    filterEvents();
                });
            });

            // Auth forms
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('eventRegistrationForm').addEventListener('submit', handleEventRegistration);
        }

        async function checkAuthStatus() {
            try {
                const response = await fetch('/api/user');
                const data = await response.json();
                
                if (data.success) {
                    currentUser = data.user;
                    updateAuthUI();
                }
            } catch (error) {
                console.error('Auth check failed:', error);
            }
        }

        function updateAuthUI() {
            if (currentUser) {
                document.getElementById('authLink').innerHTML = `<a href="#" onclick="logout()">${currentUser.full_name} - Logout</a>`;
                document.getElementById('userInfo').style.display = 'block';
                document.getElementById('userName').textContent = currentUser.full_name;
            } else {
                document.getElementById('authLink').innerHTML = '<a href="#" onclick="showAuthModal()">Sign In / Register<i class="fa-regular fa-user"></i></a>';
                document.getElementById('userInfo').style.display = 'none';
            }
        }

        async function loadEvents() {
            try {
                const response = await fetch('/api/events');
                const data = await response.json();
                
                if (data.success) {
                    allEvents = data.events;
                    displayEvents(allEvents);
                } else {
                    document.getElementById('noEventsMessage').style.display = 'block';
                }
            } catch (error) {
                console.error('Failed to load events:', error);
                document.getElementById('noEventsMessage').style.display = 'block';
            }
        }

        function displayEvents(events) {
            const container = document.getElementById('eventsContainer');
            const noEventsMsg = document.getElementById('noEventsMessage');
            
            if (events.length === 0) {
                container.innerHTML = '';
                noEventsMsg.style.display = 'block';
                return;
            }
            
            noEventsMsg.style.display = 'none';
            
            container.innerHTML = events.map(event => {
                const eventDate = new Date(event.date).toLocaleDateString();
                const eventTime = event.time.substring(0, 5);
                const isFullyBooked = event.available_slots <= 0;
                
                return `
                    <div class="col-lg-6 col-xl-4">
                        <div class="event-card">
                            <div class="event-image">
                                <div class="event-category ${event.category}">${event.category.replace('_', ' ')}</div>
                                <div class="slots-available ${isFullyBooked ? 'slots-full' : ''}">
                                    ${isFullyBooked ? 'Fully Booked' : `${event.available_slots} slots left`}
                                </div>
                            </div>
                            <div class="event-content">
                                <h3 class="event-title">${event.title}</h3>
                                <div class="event-meta">
                                    <span><i class="fa fa-calendar"></i> ${eventDate}</span>
                                    <span><i class="fa fa-clock"></i> ${eventTime}</span>
                                    <span><i class="fa fa-users"></i> ${event.capacity} max</span>
                                </div>
                                <p class="event-description">${event.description}</p>
                                <div class="event-details">
                                    <div class="event-price">$${event.amount}</div>
                                    <button class="register-btn" 
                                            onclick="registerForEvent(${event.id})"
                                            ${isFullyBooked ? 'disabled' : ''}>
                                        ${isFullyBooked ? 'Fully Booked' : 'Register Now'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterEvents() {
            if (currentFilter === 'all') {
                displayEvents(allEvents);
            } else {
                const filtered = allEvents.filter(event => event.category === currentFilter);
                displayEvents(filtered);
            }
        }

        function showAuthModal() {
            document.getElementById('authModal').style.display = 'block';
        }

        function closeAuthModal() {
            document.getElementById('authModal').style.display = 'none';
        }

        function switchToRegister() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = 'Register';
        }

        function switchToLogin() {
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = 'Sign In';
        }

        async function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentUser = data.user;
                    updateAuthUI();
                    closeAuthModal();
                    alert('Login successful!');
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('Login failed. Please try again.');
            }
        }

        async function handleRegister(e) {
            e.preventDefault();
            
            const userData = {
                username: document.getElementById('regUsername').value,
                email: document.getElementById('regEmail').value,
                password: document.getElementById('regPassword').value,
                full_name: document.getElementById('regFullName').value,
                phone: document.getElementById('regPhone').value
            };
            
            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(userData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('Registration successful! Please sign in.');
                    switchToLogin();
                    document.getElementById('registerForm').reset();
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('Registration failed. Please try again.');
            }
        }

        function registerForEvent(eventId) {
            if (!currentUser) {
                showAuthModal();
                return;
            }
            
            const event = allEvents.find(e => e.id === eventId);
            if (!event) return;
            
            if (event.available_slots <= 0) {
                alert('Sorry, this event is fully booked!');
                return;
            }
            
            // Show registration modal
            document.getElementById('selectedEventId').value = eventId;
            document.getElementById('eventDetails').innerHTML = `
                <div class="event-summary p-3 mb-4" style="background: #f8f9fa; border-radius: 8px;">
                    <h4>${event.title}</h4>
                    <p><strong>Date:</strong> ${new Date(event.date).toLocaleDateString()}</p>
                    <p><strong>Time:</strong> ${event.time.substring(0, 5)}</p>
                    <p><strong>Duration:</strong> ${event.duration}</p>
                    <p><strong>Instructor:</strong> ${event.instructor}</p>
                    <p><strong>Price:</strong> $${event.amount}</p>
                    <p><strong>Available Slots:</strong> ${event.available_slots}</p>
                </div>
            `;
            
            document.getElementById('registrationModal').style.display = 'block';
        }

        function closeRegistrationModal() {
            document.getElementById('registrationModal').style.display = 'none';
            document.getElementById('eventRegistrationForm').reset();
        }

        async function handleEventRegistration(e) {
            e.preventDefault();
            
            const eventId = document.getElementById('selectedEventId').value;
            const notes = document.getElementById('registrationNotes').value;
            
            try {
                const response = await fetch('/api/register-event', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ event_id: eventId, notes })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('Registration successful! We\'ll contact you soon with payment details.');
                    closeRegistrationModal();
                    loadEvents(); // Refresh events to update available slots
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('Registration failed. Please try again.');
            }
        }

        async function logout() {
            try {
                await fetch('/api/logout', { method: 'POST' });
                currentUser = null;
                updateAuthUI();
                alert('Logged out successfully!');
            } catch (error) {
                console.error('Logout failed:', error);
            }
        }
    </script>
</body>
</html>
